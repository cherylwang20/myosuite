<mujoco model="ping_pong_paddle">
    <include file="../../../../simhive/myo_sim/torso/assets/myotorso_arm_assets.xml"/>
    <include file="../../../../simhive/myo_sim/arm/assets/myoarm_assets.xml"/>
    <include file="../../../../simhive/myo_sim/scene/myosuite_quad.xml"/>
    <compiler angle="radian" meshdir='../../../../simhive/myo_sim' texturedir='../../../../simhive/myo_sim/'/>
    
    <visual>
        <global offwidth="1280" offheight="720"/>
    </visual>
    
    <asset>
        <!-- Ping Pong mesh and texture -->
        <mesh name="pingpong_table" file="../../envs/myo/assets/pingpong_table.obj" />
        <mesh name="pingpong_net_mesh" file="../../envs/myo/assets/pingpong_net.obj" />
        <texture name="pingpong_tex" type="2d" file="../../envs/myo/assets/PingPong.png"/>
        
        <material name="pingpong_mat" texture="pingpong_tex" specular="0.2" shininess="0.4"/>

        <!-- Ping Pong Paddle mesh and texture -->
        <mesh name="ping_pong_paddle_mesh" file="../../envs/myo/assets/Ping_Pong_Paddle.obj" />
        <texture name="paddle_tex" type="2d" file="../../envs/myo/assets/paddle_1k.png"/>
        <material name="paddle_mat" texture="paddle_tex" specular="0.2" shininess="0.4"/>

        <!-- Floor material -->
        <material name="floor_mat" rgba="0.3 0 0 1"/>
    </asset>

    <default class="main">
        <default class="visual">
            <geom group="2" type="mesh" contype="0" conaffinity="0"/>
        </default>
        <default class="collision">
            <geom group="4" condim="3" />
        </default>

        <default class="pelvis_move">
            <joint limited="true" damping="10"/>
            <position kp="100" ctrllimited="true"/>
        </default>
    </default>

    <compiler autolimits = "true" inertiafromgeom="auto" angle="radian" balanceinertia="true" boundmass="0.001" boundinertia=".0001" />
    <option timestep="0.002">
        <flag multiccd="enable"/>
    </option>
    
    <worldbody>
        <!-- Floor geom -->
        <camera name="default" pos="-1.150 -2.332 1.817" xyaxes="0.855 -0.519 0.000 0.125 0.206 0.971"/>

        <camera name="close_up" pos="0.578 0.207 1.627" xyaxes="0.225 -0.974 0.000 0.603 0.139 0.785"/>

        <!--geom name="floor" type="plane" size="5 4 0.01" pos="0 0 -0.01" material="floor_mat"/>-->
        <body name="full_body" pos="1.6 0 0.95" euler="0 0 3.14">
            <include file="../../../../simhive/myo_sim/torso/assets/myotorso_arm_chain.xml"/>
            <joint name="pelvis_x" type="slide" axis="1 0 0" damping="10000" range="-1 -0.05"/>
            <joint name="pelvis_y" type="slide" axis="0 1 0" damping="10000" range="-1 1"/>
            <include file="../../../../simhive/myo_sim/leg/assets/myolegs_chain.xml"/>
        </body>

        <light name="glow" pos="0 0 1.5" directional="false"  castshadow="true" diffuse="0.7 0.7 0.7" specular="0.5 0.5 0.5" ambient="0.52 0.52 0.52"/>
        <!-- Ping Pong geom -->
        <geom name="ping_pong_table" type="mesh" mesh="pingpong_table"
              material="pingpong_mat" rgba="1 1 1 1"
              pos="0 0 0" euler="1.57 0 0"/>
        <geom name="ping_pong_net" type="mesh" mesh="pingpong_net_mesh"
              material="pingpong_mat" rgba="1 1 1 1"
              pos="0 0 0" euler="1.57 0 0"/>

        <!--body name="ping_pong_paddle_free" pos="1 0 1.1" euler="0 0 0">
            <inertial pos="0 0 0" mass="0.1" diaginertia="0.001 0.001 0.001"/>
            <geom name="ping_pong_paddle_free" type="mesh" mesh="ping_pong_paddle_mesh"
                material="paddle_mat" rgba="1 1 1 1"
                pos="0 0 0" euler="0 0 0" class="visual"/>
            <geom name="pad_free" type="cylinder" size="0.082 0.01" pos="-0.07 0 0" class="collision"/>
            <geom name="handle_free" type="cylinder" euler="0 90 0" size="0.016 0.051" pos="0.04 0 0" class="collision"/>
        </body>-->

        <body name="pingpong" pos="0.95 0.0 1.252">
            <inertial pos="0 0 0" mass="2.7e-3" diaginertia="0.00000072 0.00000072 0.00000072"/>
            <freejoint/>
            <site name="pingpong" pos="0 0 0" group="3"/>
            <geom name="pingpong" type="sphere" size=".02" shellinertia="false" fluidcoef="0.235 0.25 0.0 1.0 1.0" group="1" rgba="0.98 0.70 0.015 1" solref="-100000 -0" fluidshape="ellipsoid"/>
        </body>

        <!-- Spotlights -->
        <!--light name="spotlight1" pos="1 1 3" dir="-1 -1 -3" cutoff="30" exponent="5" castshadow="true"/>
        <light name="spotlight2" pos="-1 -1 3" dir="1 1 -3" cutoff="30" exponent="5" castshadow="true"/>-->
    </worldbody>

    <actuator>
        <position class="pelvis_move" kp="50" name="pelvis_x" joint="pelvis_x"
                  ctrlrange="-1 0.05"/>
        <position class="pelvis_move" kp="50" name="pelvis_y" joint="pelvis_y"
                  ctrlrange="-1 1"/>
    </actuator>

    <keyframe>
        <key name="default" qpos='0 0 0 0 0 0 0 0 0 0 0 -0.0971634 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1368 0.14842 0.70695 -0.7405 -0.343225 0.805495 -0.10284 -0.08288 -0.730422 0.0568 0.1376 0 -0.26182 1.06828 0 0.56556 0.479155 0.87976 0.015708 0.871905 0.51843 0.636255 0 1.24109 0.87976 0.934745 0.05236 0.636255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1.1 0.55 1.252 1 0 0 0'/>
        <key name="dribble" qpos='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -0.0375 0.00159 -0.21783 0.2625 -0.106 0.7982 0.37812 -0.0276 -0.19034 0.00608 0.18769 0.36133 -1.072 0.81125 0.533215 -1.4139 -0.018746 0.322014 0.1528 0.0636 -0.7854 0.174505 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1.1 0.3 1.152 1 0 0 0'/>    
    </keyframe>

    </mujoco>
